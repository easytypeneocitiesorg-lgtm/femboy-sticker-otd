<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Calming Sounds</title>
<link rel="icon" href="https://cdn.discordapp.com/emojis/1406933350140215346.png?size=160" type="image/png">
<style>
    body {
        background: #ffe6f7;
        font-family: sans-serif;
        text-align: center;
        padding: 40px;
        color: #333;
    }
    h1 {
        font-size: 28px;
        margin-bottom: 20px;
    }
    .btn {
        display: block;
        width: 220px;
        margin: 12px auto;
        padding: 14px;
        border-radius: 12px;
        background: #ffbdea;
        border: none;
        cursor: pointer;
        font-size: 18px;
        transition: 0.25s;
    }
    .btn:hover {
        background: #ffc8ef;
        transform: scale(1.04);
    }
    #volumeContainer {
        margin-top: 20px;
        text-align: center;
    }
    #volumeSlider {
        width: 250px;
    }
</style>
</head>
<body>

<h1>Calming Sounds</h1>

<button class="btn" onclick="toggleSound('rain')">Rain</button>
<button class="btn" onclick="toggleSound('ocean')">Ocean Waves</button>
<button class="btn" onclick="toggleSound('fire')">Fireplace</button>
<button class="btn" onclick="toggleSound('thunder')">Thunder</button>

<button class="btn" onclick="stopAll()">Stop All</button>

<div id="volumeContainer">
    <label for="volumeSlider">Volume Slider</label><br>
    <input type="range" id="volumeSlider" min="25" max="100" value="25">
    <span id="volumeValue">100%</span>
</div>

<script>
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

const audioFiles = {
    rain: "/audio/rain.wav",
    ocean: "/audio/ocean.wav",
    fire: "/audio/fire.wav",
    thunder: "/audio/thunder.wav"
};

const sounds = {};
const gainNodes = {};
let buffersLoaded = false;

// Load audio files into buffers
const loadAllBuffers = async () => {
    for (let key in audioFiles) {
        const response = await fetch(audioFiles[key]);
        const arrayBuffer = await response.arrayBuffer();
        const audioBuffer = await audioCtx.decodeAudioData(arrayBuffer);

        // create a gain node for each sound
        const gainNode = audioCtx.createGain();
        gainNode.gain.value = 1; // base volume
        gainNode.connect(audioCtx.destination);

        gainNodes[key] = gainNode;

        sounds[key] = {
            buffer: audioBuffer,
            source: null
        };
    }
    buffersLoaded = true;
};

// Play sound
function toggleSound(name) {
    if (!buffersLoaded) return;
    stopAll();

    const source = audioCtx.createBufferSource();
    source.buffer = sounds[name].buffer;
    source.loop = true;
    source.connect(gainNodes[name]);
    source.start(0);
    sounds[name].source = source;

    document.title = capitalize(name) + " Sounds";
}

// Stop all sounds
function stopAll() {
    for (let key in sounds) {
        if (sounds[key].source) {
            sounds[key].source.stop();
            sounds[key].source.disconnect();
            sounds[key].source = null;
        }
    }
    document.title = "Calming Sounds";
}

// Volume slider
const slider = document.getElementById('volumeSlider');
const volumeDisplay = document.getElementById('volumeValue');

slider.addEventListener('input', () => {
    const multiplier = slider.value / 25; // 25 = 1x, 100 = 4x
    volumeDisplay.textContent = Math.round(multiplier * 100) + "%";

    for (let key in gainNodes) {
        gainNodes[key].gain.value = multiplier;
    }
});

function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}

// Initialize
loadAllBuffers();
</script>

</body>
</html>
